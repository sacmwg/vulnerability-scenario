------------------------------------------------------------------------------------------------
Ncurses: https://nvd.nist.gov/vuln/detail/CVE-2017-10685

ncurses 6.0   https://bugzilla.redhat.com/show_bug.cgi?id=1464692

Debian 8.0:   ncurses-bin 5.9+20140913-1 vulnerable (usr/bin/infotocap)
	      ncurses-bin 6.0+20170701-1 fixed

Ubuntu 16.04: ncurses-bin 6.0+20160213-1ubuntu1 vulnerable  (usr/bin/infotocap)

strongTNC queries:

The query for package name "ncurses-bin" returns two SWID tags. Both tags descripe ncurses
versions that are vulnerable, one for Debian 8.0 armv7l and one for Ubuntu 16.04 x86_64.
There are only installation events (action=1), one for Debian and three events for Ubuntu,
so that the vulnerability hasn't been fixed yet:
 
https://tnc.example.com/api/swid-tags/?package_name=ncurses-bin&fields=uri,software_id,package_name,version,events
[
    {
        "uri": "https://tnc.example.com/api/swid-tags/5906/", 
        "packageName": "ncurses-bin", 
        "version": "5.9+20140913-1", 
        "softwareId": "strongswan.org__Debian_8.0-armv7l-ncurses-bin-5.9~20140913-1", 
        "events": [
            {
                "event": "https://tnc.example.com/api/swid-events/445/", 
                "action": 1, 
                "recordId": 1500, 
                "sourceId": 1
            }
        ]
    }, 
    {
        "uri": "https://tnc.example.com/api/swid-tags/1357/", 
        "packageName": "ncurses-bin", 
        "version": "6.0+20160213-1ubuntu1", 
        "softwareId": "strongswan.org__Ubuntu_16.04-x86_64-ncurses-bin-6.0~20160213-1ubuntu1", 
        "events": [
            {
                "event": "https://tnc.example.com/api/swid-events/1/", 
                "action": 1, 
                "recordId": 2013, 
                "sourceId": 1
            }, 
            {
                "event": "https://tnc.example.com/api/swid-events/23/", 
                "action": 1, 
                "recordId": 3210, 
                "sourceId": 1
            }, 
            {
                "event": "https://tnc.example.com/api/swid-events/276/", 
                "action": 1, 
                "recordId": 3799, 
                "sourceId": 1
            }
        ]
    }
]

The XML-encoding of the SWID tags can be retrieved with the query

https://tnc.example.com/api/swid-tags/?package_name=ncurses-bin&fields=swid_xml
[
    {
        "swidXml":
<?xml version='1.0' encoding='UTF-8'?>
<SoftwareIdentity xmlns="http://standards.iso.org/iso/19770/-2/2015/schema.xsd" xmlns:SHA256="http://www.w3.org/2001/04/xmlenc#sha256" xmlns:n8060="http://csrc.nist.gov/schema/swid/2015-extensions/swid-2015-extensions-1.0.xsd" name="ncurses-bin" tagId="Debian_8.0-armv7l-ncurses-bin-5.9~20140913-1" version="5.9+20140913-1" versionScheme="alphanumeric">
  <Entity name="strongSwan Project" regid="strongswan.org" role="tagCreator"/>
  <Meta product="Debian 8.0 armv7l"/>
  <Payload>
    <Directory name="bin" root="/usr">
      <File SHA256:hash="d2c7bed655f185f262c347dd63a849030cd98f5c674be1c83715101f88cf81f9" name="captoinfo" size="63424"/>
      <File SHA256:hash="c54a17817802f8e831b3f010a9e3ebdfab7a885bde4e94fb8410ace153781003" name="clear" size="5600"/>
      <File SHA256:hash="1fb6bfb178ec42c96e201b004b40e92b8d96e6c45431cedc70ee1b7c4a4fe622" name="infocmp" size="51040"/>
      <File SHA256:hash="d2c7bed655f185f262c347dd63a849030cd98f5c674be1c83715101f88cf81f9" name="infotocap" size="63424"/>
      <File SHA256:hash="c364b0aed3a5a07efb821afa7423fbd313fe42607a0d1a5719e6e6e25f3f5fde" name="ncurses5-config" size="5952"/>
      <File SHA256:hash="5ece88e62c40449289c2d68819cadfffc7d95acbe573092e3944b808bd85a9cb" name="ncursesw5-config" size="5953"/>
      <File SHA256:hash="4c31c35e6109bb404ae214da57958fa8eea4608dd79cebb15e29609f773e5f3e" name="reset" size="18152"/>
      <File SHA256:hash="3ac4bd7318910446ff0f3294a4c345c633f9abb9a143e7101e5cd6c2206d7dc8" name="tabs" size="13936"/>
      <File SHA256:hash="d2c7bed655f185f262c347dd63a849030cd98f5c674be1c83715101f88cf81f9" name="tic" size="63424"/>
      <File SHA256:hash="1c2175b797a8f61ebdf5d1b019b39ab44fc0edd9ea23fbaac7a1692fe47900a6" name="toe" size="13944"/>
      <File SHA256:hash="8c47f59b32fd2b56c9b20686c6ecddf808b72f5aaf3f7abefcf53bfff8776962" name="tput" size="9880"/>
      <File SHA256:hash="4c31c35e6109bb404ae214da57958fa8eea4608dd79cebb15e29609f773e5f3e" name="tset" size="18152"/>
    </Directory>
    <Directory name="ncurses-bin" root="/usr/share/doc">
      <File SHA256:hash="d3639433b08487cfb51c3a39bfa6d3f3685915d9165db7c16d0a07ddbeb772ea" name="FAQ" size="2371"/>
      <File SHA256:hash="01a0e8a247ef9ebc5c773cfa0a841bd3e6ede61fd525b50db81fe44d6d8d81fb" name="changelog.Debian.gz" size="20246"/>
      <File SHA256:hash="8b156c2c5eae36b09a562d56aa99fe86add66614d4f66b250c67bf9b4c945f51" name="changelog.gz" size="185746"/>
      <File SHA256:hash="2b5abfe0462d4c0d8d6ef3dc9c5fa06476dd7af54406be4b863581d333cb9892" name="copyright" size="6366"/>
    </Directory>
    <Directory name="man1" root="/usr/share/man">
      <File SHA256:hash="38f391ecb88b5900a0c7adf812c30adc898cb8d60ba88eceab7522b53fe4971b" name="captoinfo.1.gz" size="2903"/>
      <File SHA256:hash="637cf28d4445197472050ee0861ce3cfc9619eb54887470064f4890403bd95d2" name="clear.1.gz" size="1192"/>
      <File SHA256:hash="63afbe533f1866967d40ffc92cdb4d90d55845f7d304a7792f86caa06b37b0e1" name="infocmp.1.gz" size="6956"/>
      <File SHA256:hash="846aa682bdc0e022fb8e4a54178303804f977ccfb09a37b738f3844721318bfd" name="infotocap.1.gz" size="1578"/>
      <File SHA256:hash="42517da49a23bf54cacd7dbef1cd927b08227a59c2c510bb4b039a814e528075" name="ncurses5-config.1.gz" size="1426"/>
      <File SHA256:hash="62b4862bb7f8cd7225104d9785b000573d9efe8b6625ff1542f65b4920cccad8" name="ncursesw5-config.1.gz" size="1425"/>
      <File SHA256:hash="028f1c1d9e482c9911493e83875087d690eb25ebbfd62be46c5390380bd1466f" name="reset.1.gz" size="4954"/>
      <File SHA256:hash="4a84aba4caf13f02e853c3890fac7dc8e334bc24416f799b7c345098b9b4615d" name="tabs.1.gz" size="2281"/>
      <File SHA256:hash="2b31fb8fa8f86334914a841ea8345883f6ce5617dc77a8f5d341a55d43f25136" name="tic.1.gz" size="5992"/>
      <File SHA256:hash="4927f2b8aece95f44927c922ed4a79844531f91d484141973d96549340f162fe" name="toe.1.gz" size="1870"/>
      <File SHA256:hash="d3790434f1c7b28ba339c381d86cd2d6c00dfd1718717bb4b09c4d07fb8243ae" name="tput.1.gz" size="4534"/>
      <File SHA256:hash="028f1c1d9e482c9911493e83875087d690eb25ebbfd62be46c5390380bd1466f" name="tset.1.gz" size="4954"/>
    </Directory>
    <Directory name="man5" root="/usr/share/man">
      <File SHA256:hash="9dfcd2e9fb0b37939b36bb9120553b44184a6b642f48c6c13aad13176f84adf7" name="term.5.gz" size="4432"/>
      <File SHA256:hash="6f002da3b15edb60b162014c98a9886233910b9bbac3a3cedf7b4370e98df789" name="terminfo.5.gz" size="34167"/>
    </Directory>
    <Directory name="man7" root="/usr/share/man">
      <File SHA256:hash="87612b5704dc5a7c7dac7ef2939e39e8fc758b9b37a8bc2627279402f7354d63" name="term.7.gz" size="4111"/>
    </Directory>
  </Payload>
</SoftwareIdentity>
    }, 
    {
        "swidXml": 
<?xml version='1.0' encoding='UTF-8'?>
<SoftwareIdentity xmlns="http://standards.iso.org/iso/19770/-2/2015/schema.xsd" xmlns:SHA256="http://www.w3.org/2001/04/xmlenc#sha256" xmlns:n8060="http://csrc.nist.gov/schema/swid/2015-extensions/swid-2015-extensions-1.0.xsd" name="ncurses-bin" tagId="Ubuntu_16.04-x86_64-ncurses-bin-6.0~20160213-1ubuntu1" version="6.0+20160213-1ubuntu1" versionScheme="alphanumeric">
  <Entity name="strongSwan Project" regid="strongswan.org" role="tagCreator"/>
  <Meta product="Ubuntu 16.04 x86_64"/>
  <Payload>
    <Directory name="bin" root="/usr">
      <File SHA256:hash="d9d25d5e3ed72bac7bf36b68e479a687dd0c5d542b3c3de16e27548dab6369e8" name="captoinfo" size="72408"/>
      <File SHA256:hash="c631f3a411be338340a67878a5641f7b899e5b12a9e788976e796b632d8dc318" name="clear" size="6224"/>
      <File SHA256:hash="4660e45965e3bf6cf9892d4983c02df28dac333e2ae87ebfca7717558d92e108" name="infocmp" size="55880"/>
      <File SHA256:hash="d9d25d5e3ed72bac7bf36b68e479a687dd0c5d542b3c3de16e27548dab6369e8" name="infotocap" size="72408"/>
      <File SHA256:hash="6e92d00091bec15f58668c99e636acdcd2cc208e78ea9009cd21a0b9b95c8e8a" name="reset" size="18864"/>
      <File SHA256:hash="c2199e074a9424ab4c5f1104c8b7aac2ab57250d1f1f3e078a94ca990d3851a6" name="tabs" size="14576"/>
      <File SHA256:hash="d9d25d5e3ed72bac7bf36b68e479a687dd0c5d542b3c3de16e27548dab6369e8" name="tic" size="72408"/>
      <File SHA256:hash="a1eea7c3864eaaeb41ccacb7dfe0ee88b63fc0f1834627595c6980c96d01591a" name="toe" size="14688"/>
      <File SHA256:hash="c388e1d1961c9e819d1318ea7cae6075857c882da2fa171c092ed35289a0ddc1" name="tput" size="14648"/>
      <File SHA256:hash="6e92d00091bec15f58668c99e636acdcd2cc208e78ea9009cd21a0b9b95c8e8a" name="tset" size="18864"/>
    </Directory>
    <Directory name="ncurses-bin" root="/usr/share/doc">
      <File SHA256:hash="d3639433b08487cfb51c3a39bfa6d3f3685915d9165db7c16d0a07ddbeb772ea" name="FAQ" size="2371"/>
      <File SHA256:hash="0fcc1ccaf54cbc23e42266107cfd23d1352e9a39457e0ac37fdec592a1539863" name="changelog.Debian.gz" size="1740"/>
      <File SHA256:hash="b7606456c4e97c19c54c67c1887a705b4d44e5121c48c851b256aeb65e518a4c" name="copyright" size="6366"/>
    </Directory>
    <Directory name="man1" root="/usr/share/man">
      <File SHA256:hash="68380ec4236b25830519eb8bfc135bfe6859964f8d863063290f1c1627020ea3" name="captoinfo.1.gz" size="2902"/>
      <File SHA256:hash="1b67c733424e909a80076413fea494f29c1cefbd7229c274eae8527f7e953b30" name="clear.1.gz" size="1192"/>
      <File SHA256:hash="ae32b237c7ced36903e94952ca820b4772a13bd41e72c72bff57c5a9eeca903a" name="infocmp.1.gz" size="7162"/>
      <File SHA256:hash="96cbb316ad9d1dbf8e6e493aab24fdca6f0c9f1fd3b03f466c885dba29d0a4e9" name="infotocap.1.gz" size="1575"/>
      <File SHA256:hash="34515343c2852235168f282b96ed8eae389d6f07dad2e4b877da4155138208e5" name="reset.1.gz" size="4980"/>
      <File SHA256:hash="3d7c51aedf0a6db9ef56b0b0dfddb00fde4fc809a44afb8ad7d9cea0465eff9f" name="tabs.1.gz" size="2279"/>
      <File SHA256:hash="8456a78e2317c927fbf36381d6ffa53c12841427346fbcd184d26826b737bb28" name="tic.1.gz" size="6122"/>
      <File SHA256:hash="cbbedaff4cce5e1f99659ff62d8e62e1a8fd4eab0baac9cba99585f2e8ecb5c3" name="toe.1.gz" size="1913"/>
      <File SHA256:hash="3a9aadff88948fa7ab04ce830efad0738b94d17cdf792cd4f9a91b0441138cac" name="tput.1.gz" size="4533"/>
      <File SHA256:hash="34515343c2852235168f282b96ed8eae389d6f07dad2e4b877da4155138208e5" name="tset.1.gz" size="4980"/>
    </Directory>
    <Directory name="man5" root="/usr/share/man">
      <File SHA256:hash="2876790c368da3fd1dac8e95eb8d4d1adb8b672396fb93f3d6f832c41ab8d4e5" name="term.5.gz" size="4424"/>
      <File SHA256:hash="942ad55831e9e04bf727ab4d47b309610e909c0cbf4e76b2faf713365c260194" name="terminfo.5.gz" size="34169"/>
    </Directory>
    <Directory name="man7" root="/usr/share/man">
      <File SHA256:hash="87612b5704dc5a7c7dac7ef2939e39e8fc758b9b37a8bc2627279402f7354d63" name="term.7.gz" size="4111"/>
    </Directory>
  </Payload>
</SoftwareIdentity>
    }
]

Both SWID tags show that the vulnerable executable "/usr/bin/infotocap" has been
distributed with these software packages.

The retrieval of the installation events returns four distinct endpoint devices
and shows the respective installation date of the vulnerable version:

https://tnc.example.com/api/swid-events/445/?fields=device,timestamp
{
    "device": "https://tnc.example.com/api/devices/4/", 
    "timestamp": "2016-05-27T11:06:15Z"
}

https://tnc.example.com/api/swid-events/1/?fields=device,timestamp
{
    "device": "https://tnc.example.com/api/devices/1/", 
    "timestamp": "2017-02-15T20:20:34Z"
}

https://tnc.example.com/api/swid-events/23/?fields=device,timestamp
{
    "device": "https://tnc.example.com/api/devices/2/", 
    "timestamp": "2016-08-29T21:56:52Z"
}

https://tnc.example.com/api/swid-events/276/?fields=device,timestamp
{
    "device": "https://tnc.example.com/api/devices/3/", 
    "timestamp": "2016-04-22T20:55:14Z"
}

In a next step we retrieve the unique hardware ID and the description
of the four vulnerable endpoints:

https://tnc.example.com/api/devices/4/?fields=value,description,product
{
    "value": "71497c4241e7c681bc3173f00f7e4ae12d530038", 
    "description": "Raspi 5", 
    "product": {
        "id": 86, 
        "uri": "https://tnc.example.com/api/products/86/", 
        "name": "Debian 8.0 armv7l"
    }
}

https://tnc.example.com/api/devices/1/?fields=value,description,product
{
    "value": "f57bfabdbaf9729133910d70c5903612301cf325", 
    "description": "SWIMA Client 1", 
    "product": {
        "id": 75, 
        "uri": "https://tnc.example.com/api/products/75/", 
        "name": "Ubuntu 16.04 x86_64"
    }
}

https://tnc.example.com/api/devices/2/?fields=value,description,product
{
{
    "value": "108fcf6d0d6a79ee529a627ba37c234717f0249c", 
    "description": "Intel NUC", 
    "product": {
        "id": 75, 
        "uri": "https://tnc.example.com/api/products/75/", 
        "name": "Ubuntu 16.04 x86_64"
    }
}

https://tnc.example.com/api/devices/3/?fields=value,description,product
{
    "value": "5d95021396d2415e5c53ca2dea6fbc1c2387c56a", 
    "description": "Lenovo  Thinkpad", 
    "product": {
        "id": 75, 
        "uri": "https://tnc.example.com/api/products/75/", 
        "name": "Ubuntu 16.04 x86_64"
    }
}

As a shortcut there is a concise summary on tag events available with the query

https://tnc.example.com/api/swid-stats/?tag=5906
[
    {
        "tag": "https://tnc.example.com/api/swid-tags/5906/", 
        "device": "https://tnc.example.com/api/devices/4/", 
        "firstSeen": "https://tnc.example.com/api/sessions/11/", 
        "lastSeen": "https://tnc.example.com/api/sessions/11/", 
        "firstInstalled": "https://tnc.example.com/api/swid-events/445/", 
        "lastDeleted": null
    }
]

https://tnc.example.com/api/swid-stats/?tag=1357
[
    {
        "tag": "https://tnc.example.com/api/swid-tags/1357/", 
        "device": "https://tnc.example.com/api/devices/1/", 
        "firstSeen": "https://tnc.example.com/api/sessions/1/", 
        "lastSeen": "https://tnc.example.com/api/sessions/1/", 
        "firstInstalled": "https://tnc.example.com/api/swid-events/1/", 
        "lastDeleted": null
    }, 
    {
        "tag": "https://tnc.example.com/api/swid-tags/1357/", 
        "device": "https://tnc.example.com/api/devices/2/", 
        "firstSeen": "https://tnc.example.com/api/sessions/4/", 
        "lastSeen": "https://tnc.example.com/api/sessions/4/", 
        "firstInstalled": "https://tnc.example.com/api/swid-events/23/", 
        "lastDeleted": null
    }, 
    {
        "tag": "https://tnc.example.com/api/swid-tags/1357/", 
        "device": "https://tnc.example.com/api/devices/3/", 
        "firstSeen": "https://tnc.example.com/api/sessions/6/", 
        "lastSeen": "https://tnc.example.com/api/sessions/6/", 
        "firstInstalled": "https://tnc.example.com/api/swid-events/276/", 
        "lastDeleted": null
    }
]

which directly gives the vulnerable devices with the package installation
and [optional] removal events.

------------------------------------------------------------------------------------------------

