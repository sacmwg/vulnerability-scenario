<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:win-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5">
    <generator>
        <oval:schema_version>5.10</oval:schema_version>
        <oval:timestamp>2017-07-15T11:40:00.000+02:00</oval:timestamp>
        <terms_of_use>Copyright (c) 2010, United States Government. All rights reserved. The contents of this file are subject to the license described in https://oval.cisecurity.org/terms.</terms_of_use>
    </generator>
    <definitions>
        <definition id="oval:org.ietf.hackathon.sacm:def:1" version="1" class="vulnerability">
            <metadata>
                <title>Vulnerable Version of Apache Webserver Due to Configuration</title>
                <reference ref_id="CVE-2016-8740" source="CVE" />
                <description>The mod_http2 module in the Apache HTTP Server 2.4.17 through 2.4.23, when the Protocols configuration includes h2 or h2c, does not restrict request-header length, which allows remote attackers to cause a denial of service (memory consumption) via crafted CONTINUATION frames in an HTTP/2 request.</description>
            </metadata>
            <criteria>
                <criterion comment="Check if a vulnerable version of Apache Webserver (httpd) is installed." test_ref="oval:org.ietf.hackathon.sacm:tst:1"/>
                <criterion comment="Check the Protocol configuration in httpd.conf." test_ref="oval:org.ietf.hackathon.sacm:tst:2"/>
            </criteria>
        </definition>
    </definitions>
    <tests>
        <xmlfilecontent_test id="oval:org.ietf.hackathon.sacm:tst:1" version="1" comment="Check if a vulnerable version of Apache Webserver is installed." check_existence="at_least_one_exists" check="at least one" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
            <object object_ref="oval:org.ietf.hackathon.sacm:obj:1"/>
            <state state_ref="oval:org.ietf.hackathon.sacm:ste:1"/>
        </xmlfilecontent_test>
        <textfilecontent_test id="oval:org.ietf.hackathon.sacm:tst:2" version="1" comment="Check the Protocol configuration in httpd.conf." check_existence="at_least_one_exists" check="all" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
            <object object_ref="oval:org.ietf.hackathon.sacm:obj:2"/>
        </textfilecontent_test>
    </tests>
    <objects>
        <xmlfilecontent_object id="oval:org.ietf.hackathon.sacm:obj:1" version="1" comment="Get all SWID tag files associated with Apache Webserver." xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
            <path>C:\Users\dhaynes\Documents\IETF\ietf99\hackathon\content\swid</path>
            <filename operation="pattern match">\.swidtag$</filename>
            <xpath>/*[local-name()='SoftwareIdentity'][contains(@name,'apache2')]/@version</xpath>
        </xmlfilecontent_object>
        <textfilecontent54_object id="oval:org.ietf.hackathon.sacm:obj:2" version="1" comment="Check the Protocols directive in httpd.conf." xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
            <!-- This will likely need to be updated to check /etc/apache2 on a Ubuntu system -->
            <path>C:\Users\dhaynes\Documents\IETF\ietf99\hackathon\content\config</path>
            <filename operation="pattern match">\.conf</filename>
            <pattern operation="pattern match">^Protocols([h2c]* )*</pattern>
            <instance datatype="int" operation="greater than or equal">0</instance>
        </textfilecontent54_object>
    </objects>
    <states>
        <xmlfilecontent_state id="oval:org.ietf.hackathon.sacm:ste:1" version="1" comment="The version of Apache Webserver is greater than or equal to 2.4.17 or less than or equal to 2.4.23." xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
            <value_of operation="pattern match">^2.4.(17|18|19|20|21|22|23)</value_of>
        </xmlfilecontent_state>
        <textfilecontent54_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:org.ietf.hackathon..sacm:ste:3" version="1">
            <subexpression operation="pattern match">^(h2|h2c)</subexpression>
        </textfilecontent54_state>
    </states>
</oval_definitions>
